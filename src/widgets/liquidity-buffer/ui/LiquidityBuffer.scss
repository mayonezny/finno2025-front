@use '@/app/styles/mixins.scss' as mix;

.liquidity-buffer {
  @include mix.widget;
  max-width: 100%;
  position: relative;
  z-index: 10;

  .detail-card {
    border: var(--border);
    border-radius: var(--border-radius);
    background: var(--color-second-bg);
    padding: 12px 16px 8px 16px;
    box-sizing: content-box;
    display: flex;
    flex-direction: column;
    gap: 4px;

    .lb-breakdown {
      gap: 4px;
    }
  }
}

.lb-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
}

.lb-toggle {
  position: relative;
  /* ключевая часть — плавная высота контейнера */
  height: auto;
  transition: height 0.28s cubic-bezier(0.22, 0.61, 0.36, 1); /* стандартный ease-out */
  will-change: height;
}

/* оба состояния лежат стопкой, анимация — через opacity + translate */
.lb-pane {
  position: absolute;
  inset: 0;
  opacity: 0;
  transform: translateY(6px) scale(0.995);
  pointer-events: none;
  height: 160px;
  transition:
    opacity 0.22s ease,
    transform 0.24s cubic-bezier(0.22, 0.61, 0.36, 1);

  &--chart {
    /* можно дать min-height, если надо фиксировать «мигание» */
  }
  &--card {
  }
}

/* активный слой */
.lb-toggle.is-chart .lb-pane--chart,
.lb-toggle.is-details .lb-pane--card {
  opacity: 1;
  transform: translateY(0) scale(1);
  pointer-events: auto;
}

/* чтобы браузер мог посчитать высоту — делаем активный слой статичным */
.lb-toggle.is-chart .lb-pane--chart,
.lb-toggle.is-details .lb-pane--card {
  position: static;
}

/* пассивный слой остаётся абсолютным и не мешает потоку */
.lb-chart-area {
  cursor: pointer;
}

.lb-sheet {
  margin-top: 0;
} /* карточка теперь в потоке активного слоя */

.lb-breakdown {
  display: grid;
  row-gap: 8px;
}
.lb-breakdown__row {
  display: grid;
  grid-template-columns: 1fr auto auto auto;
  column-gap: 12px;
  align-items: baseline;
}

.lb-trend-plus {
  color: var(--color-dark-green);
}
.lb-trend-minus {
  color: var(--color-dark-red);
}

@media (max-width: 1000px) {
  .liquidity-buffer {
    max-width: 562px;
  }
}

/* уважение к пользователям с reduced motion */
@media (prefers-reduced-motion: reduce) {
  .lb-toggle,
  .lb-pane {
    transition: none !important;
  }
}
